% !TEX root = ../main.tex
% !TEX encoding = UTF-8
% !TEX spellcheck = it-IT
% !TEX program = xelatex

\section{Composizione del dataset}
\begin{frame}[t]{Raccolta dei dati giornalieri}
  Dati meteorologici reperiti da:
  \begin{itemize}
    \item 11 dataset ARPA/SIR o provinciali;
    \item 9 dataset sovraregionali (3 italiani, 6 esteri).
  \end{itemize}
  per un totale di circa 12350 serie.

  \begin{figure}
    \centering
    \small
    \input{ASSETS/composizione_dataset/sources_availability}
    \caption*{Disponibilità temporale di alcuni dei dataset sorgenti}
  \end{figure}
\end{frame}

\begin{frame}{Raccolta dei dati giornalieri}
  Esito della raccolta è un dataset molto eterogeneo, con:
  \begin{itemize}
    \item presenza di serie completamente o parzialmente duplicate;
    \item disomogeneità e incoerenze tra dati e metadati di sorgenti differenti;
    \item generale carenza di tracce storiche delle stazioni.
  \end{itemize}

  La situazione ha richiesto un lavoro approfondito di \emph{merging} intra- e inter-dataset e di controllo manuale dei metadati.
\end{frame}

\begin{frame}[t]{\emph{Merging}: procedura}
  Combinazione di serie con strumenti della teoria dei grafi.
  \begin{columns}
    \begin{column}{0.5\textwidth}
      \begin{itemize}
        \item Regione per regione:
          \begin{enumerate}
            \item \emph{Matching}: determinazione dell'unificabilità di coppie di serie;
            \item Raggruppamento in serie rappresentative;
            \item Combinazione e integrazione ordinate;
            \item Correzione manuale dei metadati.
          \end{enumerate}
        \item \emph{Merging} complessivo a posteriori.
      \end{itemize}
    \end{column}
    \begin{column}{0.5\textwidth}
      \begin{figure}
        \includegraphics{ASSETS/composizione_dataset/reggio_series_graph_pmod.pdf}
        \caption*{Dettaglio del grafo dei \emph{match}}
      \end{figure}

    \end{column}
  \end{columns}
\end{frame}

\begin{frame}{\emph{Merging}: risultati}
  \begin{itemize}
    \item \(\approx 2500\) serie italiane (più \(1680\) straniere) di cui \(\approx 2350\) con almeno 5 anni di dati: \(\approx 3\) serie ogni \(\qty{100}{\kilo\meter^2}\);
    \item Disponibilità temporale sul trentennio significativamente superiore ai dataset sorgenti;
    \item Distribuzione geografica ben rappresentativa del territorio.
  \end{itemize}
  \begin{figure}
    \centering
    \small
    \begin{subfigure}[t]{0.45\textwidth}
      \small
      \input{ASSETS/composizione_dataset/improvements}
      \caption*{Numero di serie disponibili con almeno n anni}
    \end{subfigure}
    \hfill
    \begin{subfigure}[t]{0.45\textwidth}
      \small
      \input{ASSETS/composizione_dataset/elevation_distribution}
      \caption*{Distribuzione in quota delle serie ottenute}
    \end{subfigure}
  \end{figure}
\end{frame}

\begin{frame}{Controllo qualità ed omogeneizzazione}
  \begin{enumerate}
    \item Controllo degli errori grossolani: e.g.\ \(\lvert \mathrm{T} \rvert > \qty{50}{\degreeCelsius}\) e dati ripetuti;
    \item Confronto con serie sintetiche ERA5;
    \item Confronto con serie limitrofe;
    \item \emph{Gap filling} dei dati mancanti.
  \end{enumerate}
  Al termine del quality check sono state scartate per intero 15 serie italiane.
\end{frame}