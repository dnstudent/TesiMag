% !TEX root = ../main.tex
% !TEX encoding = UTF-8
% !TEX spellcheck = it-IT
% !TEX program = xelatex

\section{Composizione del dataset}
\begin{frame}{Raccolta dei dati giornalieri}
  \begin{columns}
    \begin{column}{0.45\textwidth}
      Esigenze:
      \begin{itemize}
        \item completezza temporale e spaziale per il trentennio 1991--2020;
        \item completezza dei metadati e accuratezza delle collocazioni;
        \item possibilità di aggiornamento futuro.
      \end{itemize}
    \end{column}
    \begin{column}{0.55\textwidth}
      Problemi riscontrati:
      \begin{itemize}
        \item disomogeneità e grande varietà nelle interfacce e informazioni fornite;
        \item incoerenze intra- e inter-dataset in merito a:
          \begin{itemize}
            \item nomi delle stazioni;
            \item codici identificativi;
            \item collocazioni geografiche ed altimetriche;
            \item definizioni di ``giornata di misura'';
            \item definizioni di estremo di temperatura.
          \end{itemize}
        \item serie duplicate.
      \end{itemize}
      Soluzione: \emph{merging} intra- e inter-dataset.
    \end{column}
  \end{columns}
\end{frame}

\begin{frame}[t]{Sorgenti}
  14 italiani + 6 stranieri tra dataset nazionali, regionali (ARPA e SIR) e provinciali.
  \begin{figure}
    \footnotesize
    \input{ASSETS/composizione_dataset/sources_availability}
    \caption*{Disponibilità temporale di alcuni dei dataset sorgenti}
  \end{figure}
\end{frame}

\begin{frame}[t]{Sorgenti}
  \begin{columns}[t]
    \begin{column}{0.5\textwidth}
      \begin{figure}
        \input{ASSETS/composizione_dataset/monthly_availabilities}
        \caption*{Disponibilità di serie dei dataset nazionali a confronto con quello prodotto.}
      \end{figure}
    \end{column}

    \begin{column}{0.5\textwidth}
      \begin{figure}
        \includegraphics[height=4cm]{ASSETS/composizione_dataset/scia_disp.png}
        \caption*{Serie di SCIA utilizzabili per il calcolo delle normali climatiche di temperatura 1991--2020.}
      \end{figure}

    \end{column}
  \end{columns}
\end{frame}

\begin{frame}[t]{\emph{Merging}: Procedura}
  Combinazione di serie singole rappresentative di una data località con strumenti della teoria dei grafi.
  \begin{columns}
    \begin{column}{0.5\textwidth}
      \begin{itemize}
        \item Regione per regione:
          \begin{itemize}
            \item \emph{Matching}: individuazione delle corrispondenze tra singole serie;
            \item Raggruppamento in serie rappresentative;
            \item Combinazione tramite modello delle differenze;
            \item Correzione manuale delle anagrafiche.
          \end{itemize}
        \item \emph{Merging} complessivo a posteriori.
      \end{itemize}
    \end{column}
    \begin{column}{0.5\textwidth}
      \begin{figure}
        \includegraphics{ASSETS/composizione_dataset/reggio_series_graph_pmod.pdf}
        \caption*{Grafo dei \emph{match} di alcune serie di Reggio Emilia.}
      \end{figure}

    \end{column}
  \end{columns}
\end{frame}

\begin{frame}{\emph{Merging}: Risultati}
  \begin{itemize}
    \item \(\approx 2500\) serie di cui \(\approx 2350\) con almeno 5 anni di dati: \(\approx 3\) serie ogni \(\qty{100}{\kilo\meter^2}\)
    \item Disponibilità temporale sul trentennio nettamente superiore ai dataset sorgenti;
    \item Distribuzione in quota ben rappresentativa del territorio.
  \end{itemize}
  \begin{figure}
    \centering
    \small
    \begin{subfigure}[t]{0.4\textwidth}
      \input{ASSETS/composizione_dataset/improvements}
      \caption*{Numero di serie disponibili con almeno n anni.}
    \end{subfigure}
    \hfill
    \begin{subfigure}[t]{0.4\textwidth}
      \input{ASSETS/composizione_dataset/elevation_distribution}
      \caption*{Distribuzione in quota delle serie ottenute.}
    \end{subfigure}
  \end{figure}
\end{frame}

\begin{frame}{Controllo qualità}
  \begin{enumerate}
    \item Controllo degli errori grezzi: \(\lvert \mathrm{T} \rvert < \qty{50}{\degreeCelsius}\) e dati ripetuti;
    \item Confronto con serie sintetiche ERA5: metodo delle anomalie e dei contributi relativi;
    \item Confronto con serie limitrofe;
    \item \emph{Gap filling} dei dati mancanti.
  \end{enumerate}
\end{frame}